#+TITLE: Majutsu NEWS -- History of notable and user-visible changes
#+AUTHOR: 0WD0

* [Unreleased]

** Added

** Changed

** Fixed

* [0.4.0] - 2025-12-18

** Added

- Support for global =--ignore-immutable= flag in rebase, squash, new, and bookmark transients.
- Support for =--ignore-immutable= in ~majutsu-describe~ and ~majutsu-edit~ via prefix argument (~C-u~).
- Region sections selection in transient for commands now supports toggling more than one commits at once.
- Magit-style per-repository process buffer (~majutsu-process-buffer~, bond to ~$~, or ~`~ for evil) for inspecting jj command output and failures.

** Changed

- Significant improvements to diff view rendering speed and memory usage.
  - Implemented "washing" to parse =jj diff= output directly in the buffer.
  - Added lazy font-locking (JIT) for diff highlighting.
  - Whitespace painting is now disabled for very large hunks to preserve responsiveness.
- Removed deprecated =--allow-new= flag from ~majutsu-git-push~.
- Keybinding of ~majutsu-abandon~ changed from ~k~ to ~k~ / ~a~.
- Replaced ~majutsu-enter-dwim~ with ~majutsu-visit-thing~, and use section keymaps so ~RET~ does the right thing in log/diff buffers (edit commit, visit file, jump to hunk).
- Diffstat summary line is now displayed as the diffstat section heading.
- ~majutsu-log-refresh~ now restores point using section successors, keeping navigation stable across operations like abandon.

** Fixed

- Trimmed timestamp strings (e.g., removing " ago") in right-margin display.
- In majutsu transients, pressing ~ESC~ / ~C-g~ while there is an active region deactivates the region (or exits visual state in evil) first instead of immediately quitting the transient.
- Fixed diffstat rendering (misaligned stat lines) in ~majutsu-diff~ when using combined =jj diff --git --stat= output.

* [0.3.0] - 2025-11-25

** Added

- Native evil support.
- Add asynchronous support for ~majutsu-log~, ~majutsu-diff~, ~majutsu-git-fetch~ and ~majutsu-git-push~.
- Basic ~majutsu-op-log~ implementation.
- Added ~majutsu-hack-dir-local-variables~, ignore trailing whitespace in majutsu buffers.
- ~majutsu-rebase-transient~ now can toggle source and destination argument type (~-b~ ~-r~ ~-s~ / ~-o~ ~-A~ ~-B~).
- ~tpl-compile~ (main entry of ~majutsu-template~) add a optional ~self-type~ argument.
- Bound ~majutsu-diff~ to ~d~.

** Changed

- Keybinding of ~majutsu-describe~ changed from ~d~ to ~c~.
- Keybinding of ~majutsu-commit~ changed from ~c~ to ~C~.
- Keybinding of ~majutsu-undo~ changed from ~u~ to ~C-/~.
- Keybinding of ~majutsu-redo~ changed from ~R~ to ~C-?~.
- Keybinding of ~majutsu-abandon~ changed from ~a~ to ~k~.
- Renamed ~majutsu-mode-transient~ to ~majutsu-dispatch~.
- Renamed ~majutsu-goto-current~ to ~majutsu-log-goto-@~.

** Fixed

- ~majutsu-log-got-@~ works based on output of =jj log= command.
- Keyword parsing in ~majutsu-template~ respects zero argument method chains.

* [0.2.0] - 2025-11-20

** Added

- Added a confirm action customization for abandon/redo/undo.
- Added ~majutsu-diff-transient~.
- Added ~majutsu-new-transient~.
- Added ~majutsu-duplicate-transient~.
- Added revset, line limit and path filter argument for ~majutsu-log-transient~.
- Added support for =jj bookmark move --allow-backwards=.
  Use ~m~ in ~majutsu-bookmark-transient~ to denote commands without flags,
  and use ~M~ for commands that include =--allow-backwards=.

** Changed

- Depend on with-editor.
- ~majutsu-diff~ and ~majutsu-describe~ now can run outside of majutsu-log buffer.
- ~majutsu-log-refresh~ tracks the section from before the refresh to keep the visuals consistent.

** Fixed

- Fixed an issue where diff sections couldn’t be toggled/collapsed.
- Don’t strip leading spaces when parsing log graphs.
- Prefer change ID, and for divergent commits (with "??" as suffix) fallback to commit ID.

* [0.1.0] - 2025-10-15

** Added

- forked form [[https://github.com/bolivier/jj-mode.el][bolivier/jj-mode.el]]
- ~majutsu-template~
